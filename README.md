# Taxi_Times_Series_Prediction
Модели прогноза кол-ва заказов такси (временные ряды) 

Цель прокта: для задачи оптимизации работы сервиса на основе исторических данных о заказах такси из аэропортов построить модель прогнозирования количества заказов такси на следующий час со средней ошибкой не более 48 заказов.

Задачи проекта:

- Провести предобработку данных

- Провести исследовательский анализ данных

- Подготовить данные для обучения моделей

- Построить несколько моделей и подобрать минимизирующие RMSE гиперпараметры

- На основе метрики RMSE выбрать лучшую модель

- Протестировать модель на тестовой выборке

- Проверить модель на адекватность

Описание даных:

Признаки

`datetime` - дата и время с интервалом в 10 минут

Целевой признак

`num_orders` - количество заказов за временной интервал

Выводы.

Целью прокта было на основе данных о заказах такси с марта по сентябрь 2018 года построить модель прогнозирования количества заказов такси на следующий час со средней ошибкой не более 48 заказов.

Предобработка данных в данном случае не понадобилась.

Временной ряд монотонный и приводимый к стационарному.

В среднем каждый час заказывали по 84 машины, за один час заказывали от 0 до 462 машин.

К концу периода (август-сентябрь) наблюдался значительный рост заказов: в среднем с 55 в марте до 160 заказов в час в конце августа. Пиковые нагрузки также пришлись на август.

Для понимания заканомерностей и построения моделей были созданы новые признаки:

sin_hour, cos_hour - синус и косиеус часа

dayofweek - день недели

month - месяц

lag_1, lag_2, lag_3 - предыдущие значения с отставанием на один, два, три часа соответственно

rolling_mean_24 - скользящее среднее за последние 24 часа

last_day - количество заказов в прогнозируемый час в предыдущие сутки

last_week - количество заказов в целевой час на предыдущей неделе в тот же день

last_days_mean - среднее в целевой час за последние 3 дня

В среднем на количество заказов рказывают влияние следующие факторы:

- время суток

- день недели

- месяц (общий тренд)

- другие факторы.

Были обучены и подобраны гиперпараметры для различных моделей регрессии со следующими результатами (RMSE) на валидационной выборке:

LinearRegression - 30

LGBMRegressor (с алгоритмами случайного леса и дерево решений с градинтным бустингом) - 32 и 31 соответственно

LGBMModel - 31

SGDRegressor - 31

Ridge - 30

DecisionTreeRegressor (макс. глубина 5) - 33

RandomForestRegressor (макс. глубина 5, кол-во деревьев 60) - 31.

В целом, на результаты обучения и качество предсказания большее влияние оказала подготовка признаков, чем подбор гиперпараметров.

По критерию минимизации ошибки RMSE и времени обучения и предсказания для тестирования были отобраны модели LinearRegression и Ridge. Ошибка RMSE на тестовой выборке для обеих моделей составила 34 заказа, что удовлетворяет условиям задачи (менее 48 заказов). Время обучения и предсказания также аналогично для обеих моделей: 15-20 миллисекунд.

Проверка модели на адекватность проводилась сравнением с результатом примитивной (Dummy) модели, предсказывающей целевое значение равным предыдущему. Ошибка Dummy-модели оказалась равной 59, что значительно выше целевой и ошибки построенных ранее моделей. Следовательно, использование построенных ранее моделей эффективно и обоснованно.
